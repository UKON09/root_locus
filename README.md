# 根轨迹分析工具 (Root Locus Analysis Tool)

这是一个基于 MATLAB 的增强版根轨迹分析工具，提供了比标准 `rlocus` 函数更丰富的分析功能和可视化效果。

## 功能特点

### 核心功能
- **根轨迹绘制**：绘制系统的完整根轨迹图
- **临界增益计算**：自动计算系统在虚轴上的交点及对应的临界增益值
- **分离点定位**：精确计算并标注根轨迹的分离点和汇合点
- **渐近线绘制**：计算并绘制根轨迹的渐近线
- **出射角/入射角**：计算复数极点的出射角和复数零点的入射角

### 增强分析
- **角度分析**：
  - 零极点与实轴的夹角
  - 复数零极点与其他点的夹角分析
  - 详细的角度和距离信息输出
- **实轴分析**：自动识别实轴上的根轨迹区段
- **图形标注**：清晰标注所有关键点和参数

## 文件说明

### `plotRootLocus.m`
主函数文件，包含所有根轨迹分析和绘图功能。

**函数原型：**
```matlab
[r, k, k_critical, asymptotes, angles] = plotRootLocus(sys)
```

**输入参数：**
- `sys`: 开环传递函数（tf 或 zpk 对象）

**输出参数：**
- `r`: 根轨迹上的极点位置矩阵
- `k`: 对应的增益向量
- `k_critical`: 临界增益值数组（虚轴交点处的增益）
- `asymptotes`: 渐近线信息结构体
  - `.center`: 渐近线中心点
  - `.angles`: 渐近线角度数组
  - `.count`: 渐近线数量
- `angles`: 出射角和入射角信息结构体
  - `.departure`: 复数极点的出射角数组
  - `.arrival`: 复数零点的入射角数组

### `sys.m`
系统模型定义文件，用于输入开环传递函数。

## 使用方法

### 1. 定义系统模型
在 `sys.m` 文件中定义你的开环传递函数。支持两种方式：

**方法一：通过零极点定义**
```matlab
sys_zeros = [];                    % 零点数组
sys_poles = [0 -20 -2-4i -2+4i];  % 极点数组
sys_gain = 1;                      % 系统增益
G = zpk(sys_zeros, sys_poles, sys_gain);
```

**方法二：直接定义传递函数**
```matlab
s = tf('s');
G = 1 / (s * (s + 20) * (s^2 + 4*s + 20));
```

### 2. 运行分析
直接运行 `sys.m` 文件即可：
```matlab
>> sys
```

### 3. 查看结果
程序将输出：
- 根轨迹图形（带完整标注）
- 控制台详细分析结果
- 所有计算参数的返回值

## 示例

当前示例分析的系统为：
```
         1
G(s) = ------------------------
       s(s + 20)(s² + 4s + 20)
```

该系统具有：
- 4个极点：0, -20, -2±4j
- 0个零点
- 系统增益：1

## 输出说明

### 图形输出
- **红色 ×**：系统极点
- **红色 ○**：系统零点（如果存在）
- **品红色 ●**：虚轴交点（临界稳定点）
- **蓝色 ■**：分离点/汇合点
- **黑色虚线**：渐近线
- **绿色箭头**：复数极点的出射角
- **红色箭头**：复数零点的入射角（如果存在）

### 控制台输出
1. **零极点与实轴夹角**：所有零极点的位置和角度信息
2. **复数零极点角度分析**：详细的相互角度和距离关系
3. **临界增益计算**：虚轴交点位置和对应的K值
4. **分离点计算**：分离点位置和对应的增益值
5. **实轴根轨迹区段**：实轴上哪些区间存在根轨迹
6. **渐近线信息**：渐近线中心和角度
7. **出射角/入射角**：复数零极点的角度信息
8. **分析总结**：系统的整体特征统计
输出示例：
=== 零极点与实轴夹角 ===
极点与实轴夹角：
极点 1: 0.0000 (实数极点，夹角 = 0°)
极点 2: -20.0000 (实数极点，夹角 = 0°)
极点 3: -2.0000+4.0000j，夹角 = 116.6°
极点 4: -2.0000-4.0000j，夹角 = -116.6°

系统无零点

=== 复数零极点与其他点的夹角分析 ===
复数极点与其他点的夹角：

极点 3 (-2.0000+4.0000j) 的角度分析：
  与其他极点的夹角：
    到极点 1 (0.0000): 角度 = 116.6°, 距离 = 4.4721
    到极点 2 (-20.0000): 角度 = 12.5°, 距离 = 18.4391
    到极点 4 (-2.0000-4.0000j): 角度 = 90.0°, 距离 = 8.0000

极点 4 (-2.0000-4.0000j) 的角度分析：
  与其他极点的夹角：
    到极点 1 (0.0000): 角度 = -116.6°, 距离 = 4.4721
    到极点 2 (-20.0000): 角度 = -12.5°, 距离 = 18.4391
    到极点 3 (-2.0000+4.0000j): 角度 = -90.0°, 距离 = 8.0000

=== 临界增益计算 ===
虚轴交点: s = ±4.0825j, 临界增益: K = 1388.8889

=== 分离点计算 ===
分离点候选点：
  s = -15.1326, K = 13881.6701

分离点验证：
  分离点 s=-15.1326 处的特征根： -15.1326+0.0000j -15.1326-0.0000j

实轴上根轨迹区段分析：
实轴上的关键点： -20.0000 -2.0000 -2.0000 0.0000
区间 [-20.0000, -2.0000] 上有根轨迹
  该区间内的分离点： -15.1326
区间 [-2.0000, -2.0000] 上有根轨迹
区间 [-2.0000, 0.0000] 上有根轨迹

=== 渐近线计算 ===
渐近线中心: σ = -6.0000
渐近线角度: 45.0° 135.0° 225.0° 315.0° 

=== 出射角/入射角计算 ===
复数极点出射角:
极点 -2.0000+4.0000j: 出射角 = -39.1°
极点 -2.0000-4.0000j: 出射角 = 39.1°

=== 分析总结 ===
系统阶数: 4 (极点数: 4, 零点数: 0)
临界增益数量: 1
分离点数量: 1
渐近线数量: 4
复数极点数量: 2
复数零点数量: 0
```

## 依赖要求

- MATLAB R2016b 或更高版本
- Control System Toolbox
- Symbolic Math Toolbox（用于临界增益计算）

## 注意事项

1. 系统必须是单输入单输出（SISO）系统
2. 传递函数必须是真分式或严格真分式
3. 对于高阶系统，计算可能需要较长时间
4. 分离点计算基于数值方法，可能存在微小误差

## 扩展使用

如果需要分析其他系统，只需修改 `sys.m` 文件中的传递函数定义即可。函数支持：
- 任意阶数的系统
- 包含复数零极点的系统
- 不同形式的传递函数表示（tf, zpk, ss）

## 故障排除

### 常见问题

1. **无法计算临界增益**
   - 可能系统在正增益下无虚轴交点
   - 检查系统是否稳定或条件稳定

2. **分离点计算失败**
   - 系统可能没有分离点
   - 检查实轴上的根轨迹区段

3. **图形显示不完整**
   - 调整坐标轴范围
   - 检查是否有极点/零点距离原点过远

## 许可证

本项目采用MIT许可证。

---

**作者**: UKON09  
**更新日期**: 2025年6月  
**版本**: 1.1
